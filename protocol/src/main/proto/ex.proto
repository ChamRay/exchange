syntax = "proto3";
package ex;

// 交易方向
enum Side {
  BUY = 0;
  SELL = 1;
}
// Time In Force 订单的有效期策略
enum Tif {
  GTC = 0; //
  IOC = 1; //
  FOK = 2; //
}

// 新订单
message NewOrder {
  string client_order_id = 1;
  string symbol = 2; // 交易品种代码
  Side side = 3;
  int64 price = 4;   // tick-scaled (e.g. price*1e4)
  int64 quantity = 5; // 单位 按最小交易单位计量
  Tif tif = 6;
  string account = 7; // 账户
  int64 ts_ns = 8; // ns时间戳
}
// 取消订单
message CancelOrder {
  string client_order_id = 1;
  string symbol = 2;
  string account = 3;
  int64 ts_ns = 4;
}
// 修改订单
message AmendOrder  {
  string client_order_id = 1;
  string symbol = 2;
  string account =3;
  int64 new_qty = 4;
  int64 new_price = 5;
  int64 ts_ns = 6;
}

message Ack {
  string client_order_id = 1;
  string engine_order_id = 2;
}
// 风控拒绝
message Reject {
  string client_order_id = 1;
  string reason = 2;
}
// 交易
message Trade {
  string symbol = 1;
  string buy_order_id = 2;
  string sell_order_id = 3;
  int64 price = 4;
  int64 quantity = 5;
  int64 seq = 6;
  int64 ts_ns = 7;
}
// 交易者 -> 撮合引擎
message Inbound {
  oneof payload {
    NewOrder new_order = 1;
    CancelOrder cancel = 2;
    AmendOrder amend = 3;
  }
}
// 撮合引擎 -> 交易者
message Outbound {
  oneof payload {
    Ack ack = 1;
    Reject reject = 2;
    Trade trade = 3;
  }
}



//
//    客户端                撮合引擎
//    │  NewOrder ───────>│
//    │  CancelOrder ────>│
//    │  AmendOrder ─────>│
//    │                   │
//    │<──── Ack ─────────│
//    │<── Reject ────────│
//    │<──── Trade ───────│

